# split estimation with SMC++
# go throught the following lines to finish the workflow 
# smc++ vcf2smc my.vcf.gz data/pop1.smc.gz <contig> pop1:ind1_1,ind1_2
# smc++ vcf2smc my.vcf.gz data/pop12.smc.gz <contig> pop1:ind1_1,ind1_2 pop2:ind2_1,ind2_2
# smc++ split -o split/ pop1/model.final.json pop2/model.final.json data/*.smc.gz
# smc++ plot joint.pdf split/model.final.json

# conda activate python2smc++

# 1. convert VCF from each sccafold for smc format including oone population
# pop 5
for i in $(cat /media/labgenoma4/DATAPART6/bandriola/Scytalopus/SummaryStats/fst/1Mscaffolds.txt); do
    smc++ vcf2smc ~/Scytalopus/vcffiles/FinalVCFs/FilteredPCA_FilteredMax30missingDepthmin5_GeographicNames_allsamples.vcf.gz pop5$i.smc.gz $i pop5:DevonianaPR2_lin5,DevonianaPR3_lin5,DevonianaPR4_lin5,DevonianaPR5_lin5,DevonianaPR6_lin5,DevonianaPR7_lin5,DevonianaPR8_lin5,DevonianaSP1_lin5,DevonianaSP2_lin5,DevonianaSP3_lin5,DevonianaSP4_lin5,NortePR1_lin7,NortePR2_lin7,NortePR3_lin7,NortePR4_lin7,NortePR5_lin7 
done

# pop 7 DO NOT USE
#for i in $(cat /media/labgenoma4/DATAPART6/bandriola/Scytalopus/SummaryStats/fst/1Mscaffolds.txt); do smc++ vcf2smc ~/Scytalopus/vcffiles/FinalVCFs/FilteredPCA_FilteredMax30missingDepthmin5_GeographicNames_allsamples.vcf.gz pop7$i.smc.gz $i pop7:CentroLestePR1_lin7,CentroLesteSC1_lin7,CentroOesteSC1_lin7,CentroOesteSC2_lin7,CentroOesteSC3_lin7,CentroOesteSC4_lin7,CentroOesteSC5_lin7,ExtremoSulRS2_lin7,ExtremoSulRS3_lin7,ExtremoSulSC1_lin7,HCentroLesteSC_lin7; done 

# pop 7 PCA no inbred
for i in $(cat /media/labgenoma4/DATAPART6/bandriola/Scytalopus/SummaryStats/fst/1Mscaffolds.txt); do
    smc++ vcf2smc ~/Scytalopus/vcffiles/FinalVCFs/FilteredPCA_FilteredMax30missingDepthmin5_GeographicNames_allsamples.vcf.gz pop7PCAnoH$i.smc.gz $i pop7PCAnoH:ExtremoSulRS2_lin7,ExtremoSulRS3_lin7,ExtremoSulSC1_lin7,CentroLestePR1_lin7,CentroLesteSC1_lin7,CentroOesteSC1_lin7,CentroOesteSC2_lin7,CentroOesteSC3_lin7,CentroOesteSC4_lin7,CentroOesteSC5_lin7
done 
# pop 6/7
for i in $(cat /media/labgenoma4/DATAPART6/bandriola/Scytalopus/SummaryStats/fst/1Mscaffolds.txt); do
    smc++ vcf2smc ~/Scytalopus/vcffiles/FinalVCFs/FilteredPCA_FilteredMax30missingDepthmin5_GeographicNames_allsamples.vcf.gz pop67$i.smc.gz $i pop67:BoaEsperanca1_lin6,BoaEsperanca2_lin6,BoaEsperanca3_lin7
done 

# 2. estimate 
# smc++ estimate <mutation rate> <data file> [<data file> ...]
# mutation rate per generation: 0,0000000025 
smc++ estimate --em-iterations 20 --ftol 1e-5 --knots 5 --spline cubic -o pop5/ --base pop5 0.0000000025 pop5VXBX01000010.1.smc.gz pop5VXBX01000098.1.smc.gz pop5VXBX01000100.1.smc.gz pop5VXBX01000102.1.smc.gz pop5VXBX01000122.1.smc.gz pop5VXBX01000330.1.smc.gz pop5VXBX01000364.1.smc.gz pop5VXBX01000450.1.smc.gz pop5VXBX01000457.1.smc.gz pop5VXBX01000547.1.smc.gz pop5VXBX01000560.1.smc.gz pop5VXBX01000659.1.smc.gz pop5VXBX01000768.1.smc.gz pop5VXBX01000771.1.smc.gz pop5VXBX01000774.1.smc.gz pop5VXBX01000786.1.smc.gz pop5VXBX01000798.1.smc.gz pop5VXBX01000899.1.smc.gz pop5VXBX01000991.1.smc.gz pop5VXBX01000994.1.smc.gz pop5VXBX01000995.1.smc.gz pop5VXBX01001047.1.smc.gz pop5VXBX01001048.1.smc.gz pop5VXBX01001056.1.smc.gz pop5VXBX01001175.1.smc.gz pop5VXBX01001194.1.smc.gz pop5VXBX01001289.1.smc.gz pop5VXBX01001290.1.smc.gz pop5VXBX01001361.1.smc.gz pop5VXBX01001501.1.smc.gz pop5VXBX01001503.1.smc.gz pop5VXBX01001580.1.smc.gz pop5VXBX01001585.1.smc.gz pop5VXBX01001600.1.smc.gz pop5VXBX01001608.1.smc.gz pop5VXBX01001698.1.smc.gz pop5VXBX01001702.1.smc.gz pop5VXBX01001788.1.smc.gz pop5VXBX01001798.1.smc.gz pop5VXBX01001802.1.smc.gz pop5VXBX01001890.1.smc.gz pop5VXBX01001934.1.smc.gz pop5VXBX01001954.1.smc.gz pop5VXBX01002012.1.smc.gz pop5VXBX01002109.1.smc.gz pop5VXBX01002127.1.smc.gz pop5VXBX01002337.1.smc.gz pop5VXBX01002363.1.smc.gz pop5VXBX01002369.1.smc.gz pop5VXBX01002494.1.smc.gz pop5VXBX01002496.1.smc.gz pop5VXBX01002499.1.smc.gz pop5VXBX01002566.1.smc.gz pop5VXBX01002579.1.smc.gz pop5VXBX01002712.1.smc.gz pop5VXBX01002725.1.smc.gz pop5VXBX01002742.1.smc.gz pop5VXBX01002809.1.smc.gz pop5VXBX01002915.1.smc.gz pop5VXBX01002916.1.smc.gz pop5VXBX01003000.1.smc.gz pop5VXBX01003014.1.smc.gz pop5VXBX01003097.1.smc.gz pop5VXBX01003108.1.smc.gz pop5VXBX01003191.1.smc.gz pop5VXBX01003263.1.smc.gz pop5VXBX01003377.1.smc.gz pop5VXBX01003474.1.smc.gz pop5VXBX01003483.1.smc.gz pop5VXBX01003639.1.smc.gz pop5VXBX01003661.1.smc.gz pop5VXBX01003745.1.smc.gz pop5VXBX01003747.1.smc.gz pop5VXBX01003748.1.smc.gz pop5VXBX01003755.1.smc.gz pop5VXBX01003761.1.smc.gz pop5VXBX01003777.1.smc.gz pop5VXBX01003868.1.smc.gz pop5VXBX01003871.1.smc.gz pop5VXBX01003936.1.smc.gz pop5VXBX01003991.1.smc.gz pop5VXBX01003997.1.smc.gz pop5VXBX01004000.1.smc.gz pop5VXBX01004046.1.smc.gz pop5VXBX01004071.1.smc.gz pop5VXBX01004089.1.smc.gz pop5VXBX01004176.1.smc.gz pop5VXBX01004178.1.smc.gz pop5VXBX01004221.1.smc.gz pop5VXBX01004249.1.smc.gz pop5VXBX01004312.1.smc.gz pop5VXBX01004397.1.smc.gz pop5VXBX01004400.1.smc.gz pop5VXBX01004429.1.smc.gz pop5VXBX01004435.1.smc.gz pop5VXBX01004442.1.smc.gz pop5VXBX01004450.1.smc.gz pop5VXBX01004599.1.smc.gz pop5VXBX01004609.1.smc.gz pop5VXBX01004616.1.smc.gz pop5VXBX01004732.1.smc.gz pop5VXBX01004733.1.smc.gz pop5VXBX01004838.1.smc.gz pop5VXBX01004892.1.smc.gz pop5VXBX01004936.1.smc.gz pop5VXBX01004943.1.smc.gz pop5VXBX01004959.1.smc.gz pop5VXBX01005001.1.smc.gz pop5VXBX01005110.1.smc.gz pop5VXBX01005113.1.smc.gz pop5VXBX01005118.1.smc.gz pop5VXBX01005186.1.smc.gz pop5VXBX01005210.1.smc.gz pop5VXBX01005245.1.smc.gz pop5VXBX01005247.1.smc.gz pop5VXBX01005253.1.smc.gz pop5VXBX01005266.1.smc.gz pop5VXBX01005325.1.smc.gz pop5VXBX01005327.1.smc.gz pop5VXBX01005335.1.smc.gz pop5VXBX01005349.1.smc.gz pop5VXBX01005472.1.smc.gz pop5VXBX01005473.1.smc.gz pop5VXBX01005595.1.smc.gz pop5VXBX01005632.1.smc.gz pop5VXBX01005702.1.smc.gz pop5VXBX01005740.1.smc.gz pop5VXBX01005867.1.smc.gz pop5VXBX01005888.1.smc.gz pop5VXBX01005896.1.smc.gz pop5VXBX01005992.1.smc.gz pop5VXBX01006119.1.smc.gz pop5VXBX01006127.1.smc.gz pop5VXBX01006128.1.smc.gz pop5VXBX01006199.1.smc.gz pop5VXBX01006201.1.smc.gz pop5VXBX01006211.1.smc.gz pop5VXBX01006417.1.smc.gz pop5VXBX01006518.1.smc.gz pop5VXBX01006519.1.smc.gz pop5VXBX01006670.1.smc.gz pop5VXBX01006700.1.smc.gz pop5VXBX01006773.1.smc.gz pop5VXBX01006808.1.smc.gz pop5VXBX01006869.1.smc.gz pop5VXBX01006871.1.smc.gz pop5VXBX01006882.1.smc.gz pop5VXBX01006887.1.smc.gz pop5VXBX01007003.1.smc.gz pop5VXBX01007086.1.smc.gz pop5VXBX01007117.1.smc.gz pop5VXBX01007125.1.smc.gz pop5VXBX01007131.1.smc.gz pop5VXBX01007486.1.smc.gz pop5VXBX01007491.1.smc.gz pop5VXBX01007493.1.smc.gz pop5VXBX01007602.1.smc.gz pop5VXBX01007692.1.smc.gz pop5VXBX01007701.1.smc.gz pop5VXBX01007708.1.smc.gz pop5VXBX01007777.1.smc.gz pop5VXBX01007795.1.smc.gz pop5VXBX01007914.1.smc.gz pop5VXBX01007981.1.smc.gz pop5VXBX01007997.1.smc.gz pop5VXBX01008007.1.smc.gz pop5VXBX01008012.1.smc.gz pop5VXBX01008036.1.smc.gz pop5VXBX01008045.1.smc.gz pop5VXBX01008125.1.smc.gz pop5VXBX01008133.1.smc.gz pop5VXBX01008140.1.smc.gz pop5VXBX01008145.1.smc.gz pop5VXBX01008146.1.smc.gz pop5VXBX01008206.1.smc.gz pop5VXBX01008231.1.smc.gz pop5VXBX01008236.1.smc.gz pop5VXBX01008290.1.smc.gz pop5VXBX01008400.1.smc.gz pop5VXBX01008415.1.smc.gz pop5VXBX01008451.1.smc.gz pop5VXBX01008453.1.smc.gz pop5VXBX01008464.1.smc.gz pop5VXBX01008609.1.smc.gz pop5VXBX01008674.1.smc.gz pop5VXBX01008688.1.smc.gz pop5VXBX01008695.1.smc.gz pop5VXBX01008995.1.smc.gz pop5VXBX01009008.1.smc.gz pop5VXBX01009038.1.smc.gz pop5VXBX01009069.1.smc.gz pop5VXBX01009108.1.smc.gz pop5VXBX01009114.1.smc.gz pop5VXBX01009215.1.smc.gz pop5VXBX01009292.1.smc.gz pop5VXBX01009313.1.smc.gz pop5VXBX01009318.1.smc.gz pop5VXBX01009357.1.smc.gz pop5VXBX01009439.1.smc.gz pop5VXBX01009446.1.smc.gz pop5VXBX01009452.1.smc.gz pop5VXBX01009469.1.smc.gz pop5VXBX01009535.1.smc.gz pop5VXBX01009581.1.smc.gz pop5VXBX01009582.1.smc.gz pop5VXBX01009584.1.smc.gz pop5VXBX01009605.1.smc.gz pop5VXBX01009614.1.smc.gz pop5VXBX01009752.1.smc.gz pop5VXBX01009827.1.smc.gz pop5VXBX01009832.1.smc.gz pop5VXBX01009855.1.smc.gz pop5VXBX01009899.1.smc.gz pop5VXBX01009908.1.smc.gz pop5VXBX01009921.1.smc.gz pop5VXBX01017515.1.smc.gz
smc++ estimate --em-iterations 20 --ftol 1e-5 --knots 5 --spline cubic -o pop67/ --base pop67 0.0000000025 pop67VXBX01000010.1.smc.gz pop67VXBX01000098.1.smc.gz pop67VXBX01000100.1.smc.gz pop67VXBX01000102.1.smc.gz pop67VXBX01000122.1.smc.gz pop67VXBX01000330.1.smc.gz pop67VXBX01000364.1.smc.gz pop67VXBX01000450.1.smc.gz pop67VXBX01000457.1.smc.gz pop67VXBX01000547.1.smc.gz pop67VXBX01000560.1.smc.gz pop67VXBX01000659.1.smc.gz pop67VXBX01000768.1.smc.gz pop67VXBX01000771.1.smc.gz pop67VXBX01000774.1.smc.gz pop67VXBX01000786.1.smc.gz pop67VXBX01000798.1.smc.gz pop67VXBX01000899.1.smc.gz pop67VXBX01000991.1.smc.gz pop67VXBX01000994.1.smc.gz pop67VXBX01000995.1.smc.gz pop67VXBX01001047.1.smc.gz pop67VXBX01001048.1.smc.gz pop67VXBX01001056.1.smc.gz pop67VXBX01001175.1.smc.gz pop67VXBX01001194.1.smc.gz pop67VXBX01001289.1.smc.gz pop67VXBX01001290.1.smc.gz pop67VXBX01001361.1.smc.gz pop67VXBX01001501.1.smc.gz pop67VXBX01001503.1.smc.gz pop67VXBX01001580.1.smc.gz pop67VXBX01001585.1.smc.gz pop67VXBX01001600.1.smc.gz pop67VXBX01001608.1.smc.gz pop67VXBX01001698.1.smc.gz pop67VXBX01001702.1.smc.gz pop67VXBX01001788.1.smc.gz pop67VXBX01001798.1.smc.gz pop67VXBX01001802.1.smc.gz pop67VXBX01001890.1.smc.gz pop67VXBX01001934.1.smc.gz pop67VXBX01001954.1.smc.gz pop67VXBX01002012.1.smc.gz pop67VXBX01002109.1.smc.gz pop67VXBX01002127.1.smc.gz pop67VXBX01002337.1.smc.gz pop67VXBX01002363.1.smc.gz pop67VXBX01002369.1.smc.gz pop67VXBX01002494.1.smc.gz pop67VXBX01002496.1.smc.gz pop67VXBX01002499.1.smc.gz pop67VXBX01002566.1.smc.gz pop67VXBX01002579.1.smc.gz pop67VXBX01002712.1.smc.gz pop67VXBX01002725.1.smc.gz pop67VXBX01002742.1.smc.gz pop67VXBX01002809.1.smc.gz pop67VXBX01002915.1.smc.gz pop67VXBX01002916.1.smc.gz pop67VXBX01003000.1.smc.gz pop67VXBX01003014.1.smc.gz pop67VXBX01003097.1.smc.gz pop67VXBX01003108.1.smc.gz pop67VXBX01003191.1.smc.gz pop67VXBX01003263.1.smc.gz pop67VXBX01003377.1.smc.gz pop67VXBX01003474.1.smc.gz pop67VXBX01003483.1.smc.gz pop67VXBX01003639.1.smc.gz pop67VXBX01003661.1.smc.gz pop67VXBX01003745.1.smc.gz pop67VXBX01003747.1.smc.gz pop67VXBX01003748.1.smc.gz pop67VXBX01003755.1.smc.gz pop67VXBX01003761.1.smc.gz pop67VXBX01003777.1.smc.gz pop67VXBX01003868.1.smc.gz pop67VXBX01003871.1.smc.gz pop67VXBX01003936.1.smc.gz pop67VXBX01003991.1.smc.gz pop67VXBX01003997.1.smc.gz pop67VXBX01004000.1.smc.gz pop67VXBX01004046.1.smc.gz pop67VXBX01004071.1.smc.gz pop67VXBX01004089.1.smc.gz pop67VXBX01004176.1.smc.gz pop67VXBX01004178.1.smc.gz pop67VXBX01004221.1.smc.gz pop67VXBX01004249.1.smc.gz pop67VXBX01004312.1.smc.gz pop67VXBX01004397.1.smc.gz pop67VXBX01004400.1.smc.gz pop67VXBX01004429.1.smc.gz pop67VXBX01004435.1.smc.gz pop67VXBX01004442.1.smc.gz pop67VXBX01004450.1.smc.gz pop67VXBX01004599.1.smc.gz pop67VXBX01004609.1.smc.gz pop67VXBX01004616.1.smc.gz pop67VXBX01004732.1.smc.gz pop67VXBX01004733.1.smc.gz pop67VXBX01004838.1.smc.gz pop67VXBX01004892.1.smc.gz pop67VXBX01004936.1.smc.gz pop67VXBX01004943.1.smc.gz pop67VXBX01004959.1.smc.gz pop67VXBX01005001.1.smc.gz pop67VXBX01005110.1.smc.gz pop67VXBX01005113.1.smc.gz pop67VXBX01005118.1.smc.gz pop67VXBX01005186.1.smc.gz pop67VXBX01005210.1.smc.gz pop67VXBX01005245.1.smc.gz pop67VXBX01005247.1.smc.gz pop67VXBX01005253.1.smc.gz pop67VXBX01005266.1.smc.gz pop67VXBX01005325.1.smc.gz pop67VXBX01005327.1.smc.gz pop67VXBX01005335.1.smc.gz pop67VXBX01005349.1.smc.gz pop67VXBX01005472.1.smc.gz pop67VXBX01005473.1.smc.gz pop67VXBX01005595.1.smc.gz pop67VXBX01005632.1.smc.gz pop67VXBX01005702.1.smc.gz pop67VXBX01005740.1.smc.gz pop67VXBX01005867.1.smc.gz pop67VXBX01005888.1.smc.gz pop67VXBX01005896.1.smc.gz pop67VXBX01005992.1.smc.gz pop67VXBX01006119.1.smc.gz pop67VXBX01006127.1.smc.gz pop67VXBX01006128.1.smc.gz pop67VXBX01006199.1.smc.gz pop67VXBX01006201.1.smc.gz pop67VXBX01006211.1.smc.gz pop67VXBX01006417.1.smc.gz pop67VXBX01006518.1.smc.gz pop67VXBX01006519.1.smc.gz pop67VXBX01006670.1.smc.gz pop67VXBX01006700.1.smc.gz pop67VXBX01006773.1.smc.gz pop67VXBX01006808.1.smc.gz pop67VXBX01006869.1.smc.gz pop67VXBX01006871.1.smc.gz pop67VXBX01006882.1.smc.gz pop67VXBX01006887.1.smc.gz pop67VXBX01007003.1.smc.gz pop67VXBX01007086.1.smc.gz pop67VXBX01007117.1.smc.gz pop67VXBX01007125.1.smc.gz pop67VXBX01007131.1.smc.gz pop67VXBX01007486.1.smc.gz pop67VXBX01007491.1.smc.gz pop67VXBX01007493.1.smc.gz pop67VXBX01007602.1.smc.gz pop67VXBX01007692.1.smc.gz pop67VXBX01007701.1.smc.gz pop67VXBX01007708.1.smc.gz pop67VXBX01007777.1.smc.gz pop67VXBX01007795.1.smc.gz pop67VXBX01007914.1.smc.gz pop67VXBX01007981.1.smc.gz pop67VXBX01007997.1.smc.gz pop67VXBX01008007.1.smc.gz pop67VXBX01008012.1.smc.gz pop67VXBX01008036.1.smc.gz pop67VXBX01008045.1.smc.gz pop67VXBX01008125.1.smc.gz pop67VXBX01008133.1.smc.gz pop67VXBX01008140.1.smc.gz pop67VXBX01008145.1.smc.gz pop67VXBX01008146.1.smc.gz pop67VXBX01008206.1.smc.gz pop67VXBX01008231.1.smc.gz pop67VXBX01008236.1.smc.gz pop67VXBX01008290.1.smc.gz pop67VXBX01008400.1.smc.gz pop67VXBX01008415.1.smc.gz pop67VXBX01008451.1.smc.gz pop67VXBX01008453.1.smc.gz pop67VXBX01008464.1.smc.gz pop67VXBX01008609.1.smc.gz pop67VXBX01008674.1.smc.gz pop67VXBX01008688.1.smc.gz pop67VXBX01008695.1.smc.gz pop67VXBX01008995.1.smc.gz pop67VXBX01009008.1.smc.gz pop67VXBX01009038.1.smc.gz pop67VXBX01009069.1.smc.gz pop67VXBX01009108.1.smc.gz pop67VXBX01009114.1.smc.gz pop67VXBX01009215.1.smc.gz pop67VXBX01009292.1.smc.gz pop67VXBX01009313.1.smc.gz pop67VXBX01009318.1.smc.gz pop67VXBX01009357.1.smc.gz pop67VXBX01009439.1.smc.gz pop67VXBX01009446.1.smc.gz pop67VXBX01009452.1.smc.gz pop67VXBX01009469.1.smc.gz pop67VXBX01009535.1.smc.gz pop67VXBX01009581.1.smc.gz pop67VXBX01009582.1.smc.gz pop67VXBX01009584.1.smc.gz pop67VXBX01009605.1.smc.gz pop67VXBX01009614.1.smc.gz pop67VXBX01009752.1.smc.gz pop67VXBX01009827.1.smc.gz pop67VXBX01009832.1.smc.gz pop67VXBX01009855.1.smc.gz pop67VXBX01009899.1.smc.gz pop67VXBX01009908.1.smc.gz pop67VXBX01009921.1.smc.gz pop67VXBX01017515.1.smc.gz
#smc++ estimate --em-iterations 20 --ftol 1e-5 --knots 5 --spline cubic -o pop7/ --base pop7 0.0000000025 pop7VXBX01000010.1.smc.gz pop7VXBX01000098.1.smc.gz pop7VXBX01000100.1.smc.gz pop7VXBX01000102.1.smc.gz pop7VXBX01000122.1.smc.gz pop7VXBX01000330.1.smc.gz pop7VXBX01000364.1.smc.gz pop7VXBX01000450.1.smc.gz pop7VXBX01000457.1.smc.gz pop7VXBX01000547.1.smc.gz pop7VXBX01000560.1.smc.gz pop7VXBX01000659.1.smc.gz pop7VXBX01000768.1.smc.gz pop7VXBX01000771.1.smc.gz pop7VXBX01000774.1.smc.gz pop7VXBX01000786.1.smc.gz pop7VXBX01000798.1.smc.gz pop7VXBX01000899.1.smc.gz pop7VXBX01000991.1.smc.gz pop7VXBX01000994.1.smc.gz pop7VXBX01000995.1.smc.gz pop7VXBX01001047.1.smc.gz pop7VXBX01001048.1.smc.gz pop7VXBX01001056.1.smc.gz pop7VXBX01001175.1.smc.gz pop7VXBX01001194.1.smc.gz pop7VXBX01001289.1.smc.gz pop7VXBX01001290.1.smc.gz pop7VXBX01001361.1.smc.gz pop7VXBX01001501.1.smc.gz pop7VXBX01001503.1.smc.gz pop7VXBX01001580.1.smc.gz pop7VXBX01001585.1.smc.gz pop7VXBX01001600.1.smc.gz pop7VXBX01001608.1.smc.gz pop7VXBX01001698.1.smc.gz pop7VXBX01001702.1.smc.gz pop7VXBX01001788.1.smc.gz pop7VXBX01001798.1.smc.gz pop7VXBX01001802.1.smc.gz pop7VXBX01001890.1.smc.gz pop7VXBX01001934.1.smc.gz pop7VXBX01001954.1.smc.gz pop7VXBX01002012.1.smc.gz pop7VXBX01002109.1.smc.gz pop7VXBX01002127.1.smc.gz pop7VXBX01002337.1.smc.gz pop7VXBX01002363.1.smc.gz pop7VXBX01002369.1.smc.gz pop7VXBX01002494.1.smc.gz pop7VXBX01002496.1.smc.gz pop7VXBX01002499.1.smc.gz pop7VXBX01002566.1.smc.gz pop7VXBX01002579.1.smc.gz pop7VXBX01002712.1.smc.gz pop7VXBX01002725.1.smc.gz pop7VXBX01002742.1.smc.gz pop7VXBX01002809.1.smc.gz pop7VXBX01002915.1.smc.gz pop7VXBX01002916.1.smc.gz pop7VXBX01003000.1.smc.gz pop7VXBX01003014.1.smc.gz pop7VXBX01003097.1.smc.gz pop7VXBX01003108.1.smc.gz pop7VXBX01003191.1.smc.gz pop7VXBX01003263.1.smc.gz pop7VXBX01003377.1.smc.gz pop7VXBX01003474.1.smc.gz pop7VXBX01003483.1.smc.gz pop7VXBX01003639.1.smc.gz pop7VXBX01003661.1.smc.gz pop7VXBX01003745.1.smc.gz pop7VXBX01003747.1.smc.gz pop7VXBX01003748.1.smc.gz pop7VXBX01003755.1.smc.gz pop7VXBX01003761.1.smc.gz pop7VXBX01003777.1.smc.gz pop7VXBX01003868.1.smc.gz pop7VXBX01003871.1.smc.gz pop7VXBX01003936.1.smc.gz pop7VXBX01003991.1.smc.gz pop7VXBX01003997.1.smc.gz pop7VXBX01004000.1.smc.gz pop7VXBX01004046.1.smc.gz pop7VXBX01004071.1.smc.gz pop7VXBX01004089.1.smc.gz pop7VXBX01004176.1.smc.gz pop7VXBX01004178.1.smc.gz pop7VXBX01004221.1.smc.gz pop7VXBX01004249.1.smc.gz pop7VXBX01004312.1.smc.gz pop7VXBX01004397.1.smc.gz pop7VXBX01004400.1.smc.gz pop7VXBX01004429.1.smc.gz pop7VXBX01004435.1.smc.gz pop7VXBX01004442.1.smc.gz pop7VXBX01004450.1.smc.gz pop7VXBX01004599.1.smc.gz pop7VXBX01004609.1.smc.gz pop7VXBX01004616.1.smc.gz pop7VXBX01004732.1.smc.gz pop7VXBX01004733.1.smc.gz pop7VXBX01004838.1.smc.gz pop7VXBX01004892.1.smc.gz pop7VXBX01004936.1.smc.gz pop7VXBX01004943.1.smc.gz pop7VXBX01004959.1.smc.gz pop7VXBX01005001.1.smc.gz pop7VXBX01005110.1.smc.gz pop7VXBX01005113.1.smc.gz pop7VXBX01005118.1.smc.gz pop7VXBX01005186.1.smc.gz pop7VXBX01005210.1.smc.gz pop7VXBX01005245.1.smc.gz pop7VXBX01005247.1.smc.gz pop7VXBX01005253.1.smc.gz pop7VXBX01005266.1.smc.gz pop7VXBX01005325.1.smc.gz pop7VXBX01005327.1.smc.gz pop7VXBX01005335.1.smc.gz pop7VXBX01005349.1.smc.gz pop7VXBX01005472.1.smc.gz pop7VXBX01005473.1.smc.gz pop7VXBX01005595.1.smc.gz pop7VXBX01005632.1.smc.gz pop7VXBX01005702.1.smc.gz pop7VXBX01005740.1.smc.gz pop7VXBX01005867.1.smc.gz pop7VXBX01005888.1.smc.gz pop7VXBX01005896.1.smc.gz pop7VXBX01005992.1.smc.gz pop7VXBX01006119.1.smc.gz pop7VXBX01006127.1.smc.gz pop7VXBX01006128.1.smc.gz pop7VXBX01006199.1.smc.gz pop7VXBX01006201.1.smc.gz pop7VXBX01006211.1.smc.gz pop7VXBX01006417.1.smc.gz pop7VXBX01006518.1.smc.gz pop7VXBX01006519.1.smc.gz pop7VXBX01006670.1.smc.gz pop7VXBX01006700.1.smc.gz pop7VXBX01006773.1.smc.gz pop7VXBX01006808.1.smc.gz pop7VXBX01006869.1.smc.gz pop7VXBX01006871.1.smc.gz pop7VXBX01006882.1.smc.gz pop7VXBX01006887.1.smc.gz pop7VXBX01007003.1.smc.gz pop7VXBX01007086.1.smc.gz pop7VXBX01007117.1.smc.gz pop7VXBX01007125.1.smc.gz pop7VXBX01007131.1.smc.gz pop7VXBX01007486.1.smc.gz pop7VXBX01007491.1.smc.gz pop7VXBX01007493.1.smc.gz pop7VXBX01007602.1.smc.gz pop7VXBX01007692.1.smc.gz pop7VXBX01007701.1.smc.gz pop7VXBX01007708.1.smc.gz pop7VXBX01007777.1.smc.gz pop7VXBX01007795.1.smc.gz pop7VXBX01007914.1.smc.gz pop7VXBX01007981.1.smc.gz pop7VXBX01007997.1.smc.gz pop7VXBX01008007.1.smc.gz pop7VXBX01008012.1.smc.gz pop7VXBX01008036.1.smc.gz pop7VXBX01008045.1.smc.gz pop7VXBX01008125.1.smc.gz pop7VXBX01008133.1.smc.gz pop7VXBX01008140.1.smc.gz pop7VXBX01008145.1.smc.gz pop7VXBX01008146.1.smc.gz pop7VXBX01008206.1.smc.gz pop7VXBX01008231.1.smc.gz pop7VXBX01008236.1.smc.gz pop7VXBX01008290.1.smc.gz pop7VXBX01008400.1.smc.gz pop7VXBX01008415.1.smc.gz pop7VXBX01008451.1.smc.gz pop7VXBX01008453.1.smc.gz pop7VXBX01008464.1.smc.gz pop7VXBX01008609.1.smc.gz pop7VXBX01008674.1.smc.gz pop7VXBX01008688.1.smc.gz pop7VXBX01008695.1.smc.gz pop7VXBX01008995.1.smc.gz pop7VXBX01009008.1.smc.gz pop7VXBX01009038.1.smc.gz pop7VXBX01009069.1.smc.gz pop7VXBX01009108.1.smc.gz pop7VXBX01009114.1.smc.gz pop7VXBX01009215.1.smc.gz pop7VXBX01009292.1.smc.gz pop7VXBX01009313.1.smc.gz pop7VXBX01009318.1.smc.gz pop7VXBX01009357.1.smc.gz pop7VXBX01009439.1.smc.gz pop7VXBX01009446.1.smc.gz pop7VXBX01009452.1.smc.gz pop7VXBX01009469.1.smc.gz pop7VXBX01009535.1.smc.gz pop7VXBX01009581.1.smc.gz pop7VXBX01009582.1.smc.gz pop7VXBX01009584.1.smc.gz pop7VXBX01009605.1.smc.gz pop7VXBX01009614.1.smc.gz pop7VXBX01009752.1.smc.gz pop7VXBX01009827.1.smc.gz pop7VXBX01009832.1.smc.gz pop7VXBX01009855.1.smc.gz pop7VXBX01009899.1.smc.gz pop7VXBX01009908.1.smc.gz pop7VXBX01009921.1.smc.gz pop7VXBX01017515.1.smc.gz
smc++ estimate --em-iterations 20 --ftol 1e-5 --knots 5 --spline cubic -o pop7PCAnoH/ --base pop7PCAnoH 0.0000000025 pop7PCAnoHVXBX01000010.1.smc.gz pop7PCAnoHVXBX01000098.1.smc.gz pop7PCAnoHVXBX01000100.1.smc.gz pop7PCAnoHVXBX01000102.1.smc.gz pop7PCAnoHVXBX01000122.1.smc.gz pop7PCAnoHVXBX01000330.1.smc.gz pop7PCAnoHVXBX01000364.1.smc.gz pop7PCAnoHVXBX01000450.1.smc.gz pop7PCAnoHVXBX01000457.1.smc.gz pop7PCAnoHVXBX01000547.1.smc.gz pop7PCAnoHVXBX01000560.1.smc.gz pop7PCAnoHVXBX01000659.1.smc.gz pop7PCAnoHVXBX01000768.1.smc.gz pop7PCAnoHVXBX01000771.1.smc.gz pop7PCAnoHVXBX01000774.1.smc.gz pop7PCAnoHVXBX01000786.1.smc.gz pop7PCAnoHVXBX01000798.1.smc.gz pop7PCAnoHVXBX01000899.1.smc.gz pop7PCAnoHVXBX01000991.1.smc.gz pop7PCAnoHVXBX01000994.1.smc.gz pop7PCAnoHVXBX01000995.1.smc.gz pop7PCAnoHVXBX01001047.1.smc.gz pop7PCAnoHVXBX01001048.1.smc.gz pop7PCAnoHVXBX01001056.1.smc.gz pop7PCAnoHVXBX01001175.1.smc.gz pop7PCAnoHVXBX01001194.1.smc.gz pop7PCAnoHVXBX01001289.1.smc.gz pop7PCAnoHVXBX01001290.1.smc.gz pop7PCAnoHVXBX01001361.1.smc.gz pop7PCAnoHVXBX01001501.1.smc.gz pop7PCAnoHVXBX01001503.1.smc.gz pop7PCAnoHVXBX01001580.1.smc.gz pop7PCAnoHVXBX01001585.1.smc.gz pop7PCAnoHVXBX01001600.1.smc.gz pop7PCAnoHVXBX01001608.1.smc.gz pop7PCAnoHVXBX01001698.1.smc.gz pop7PCAnoHVXBX01001702.1.smc.gz pop7PCAnoHVXBX01001788.1.smc.gz pop7PCAnoHVXBX01001798.1.smc.gz pop7PCAnoHVXBX01001802.1.smc.gz pop7PCAnoHVXBX01001890.1.smc.gz pop7PCAnoHVXBX01001934.1.smc.gz pop7PCAnoHVXBX01001954.1.smc.gz pop7PCAnoHVXBX01002012.1.smc.gz pop7PCAnoHVXBX01002109.1.smc.gz pop7PCAnoHVXBX01002127.1.smc.gz pop7PCAnoHVXBX01002337.1.smc.gz pop7PCAnoHVXBX01002363.1.smc.gz pop7PCAnoHVXBX01002369.1.smc.gz pop7PCAnoHVXBX01002494.1.smc.gz pop7PCAnoHVXBX01002496.1.smc.gz pop7PCAnoHVXBX01002499.1.smc.gz pop7PCAnoHVXBX01002566.1.smc.gz pop7PCAnoHVXBX01002579.1.smc.gz pop7PCAnoHVXBX01002712.1.smc.gz pop7PCAnoHVXBX01002725.1.smc.gz pop7PCAnoHVXBX01002742.1.smc.gz pop7PCAnoHVXBX01002809.1.smc.gz pop7PCAnoHVXBX01002915.1.smc.gz pop7PCAnoHVXBX01002916.1.smc.gz pop7PCAnoHVXBX01003000.1.smc.gz pop7PCAnoHVXBX01003014.1.smc.gz pop7PCAnoHVXBX01003097.1.smc.gz pop7PCAnoHVXBX01003108.1.smc.gz pop7PCAnoHVXBX01003191.1.smc.gz pop7PCAnoHVXBX01003263.1.smc.gz pop7PCAnoHVXBX01003377.1.smc.gz pop7PCAnoHVXBX01003474.1.smc.gz pop7PCAnoHVXBX01003483.1.smc.gz pop7PCAnoHVXBX01003639.1.smc.gz pop7PCAnoHVXBX01003661.1.smc.gz pop7PCAnoHVXBX01003745.1.smc.gz pop7PCAnoHVXBX01003747.1.smc.gz pop7PCAnoHVXBX01003748.1.smc.gz pop7PCAnoHVXBX01003755.1.smc.gz pop7PCAnoHVXBX01003761.1.smc.gz pop7PCAnoHVXBX01003777.1.smc.gz pop7PCAnoHVXBX01003868.1.smc.gz pop7PCAnoHVXBX01003871.1.smc.gz pop7PCAnoHVXBX01003936.1.smc.gz pop7PCAnoHVXBX01003991.1.smc.gz pop7PCAnoHVXBX01003997.1.smc.gz pop7PCAnoHVXBX01004000.1.smc.gz pop7PCAnoHVXBX01004046.1.smc.gz pop7PCAnoHVXBX01004071.1.smc.gz pop7PCAnoHVXBX01004089.1.smc.gz pop7PCAnoHVXBX01004176.1.smc.gz pop7PCAnoHVXBX01004178.1.smc.gz pop7PCAnoHVXBX01004221.1.smc.gz pop7PCAnoHVXBX01004249.1.smc.gz pop7PCAnoHVXBX01004312.1.smc.gz pop7PCAnoHVXBX01004397.1.smc.gz pop7PCAnoHVXBX01004400.1.smc.gz pop7PCAnoHVXBX01004429.1.smc.gz pop7PCAnoHVXBX01004435.1.smc.gz pop7PCAnoHVXBX01004442.1.smc.gz pop7PCAnoHVXBX01004450.1.smc.gz pop7PCAnoHVXBX01004599.1.smc.gz pop7PCAnoHVXBX01004609.1.smc.gz pop7PCAnoHVXBX01004616.1.smc.gz pop7PCAnoHVXBX01004732.1.smc.gz pop7PCAnoHVXBX01004733.1.smc.gz pop7PCAnoHVXBX01004838.1.smc.gz pop7PCAnoHVXBX01004892.1.smc.gz pop7PCAnoHVXBX01004936.1.smc.gz pop7PCAnoHVXBX01004943.1.smc.gz pop7PCAnoHVXBX01004959.1.smc.gz pop7PCAnoHVXBX01005001.1.smc.gz pop7PCAnoHVXBX01005110.1.smc.gz pop7PCAnoHVXBX01005113.1.smc.gz pop7PCAnoHVXBX01005118.1.smc.gz pop7PCAnoHVXBX01005186.1.smc.gz pop7PCAnoHVXBX01005210.1.smc.gz pop7PCAnoHVXBX01005245.1.smc.gz pop7PCAnoHVXBX01005247.1.smc.gz pop7PCAnoHVXBX01005253.1.smc.gz pop7PCAnoHVXBX01005266.1.smc.gz pop7PCAnoHVXBX01005325.1.smc.gz pop7PCAnoHVXBX01005327.1.smc.gz pop7PCAnoHVXBX01005335.1.smc.gz pop7PCAnoHVXBX01005349.1.smc.gz pop7PCAnoHVXBX01005472.1.smc.gz pop7PCAnoHVXBX01005473.1.smc.gz pop7PCAnoHVXBX01005595.1.smc.gz pop7PCAnoHVXBX01005632.1.smc.gz pop7PCAnoHVXBX01005702.1.smc.gz pop7PCAnoHVXBX01005740.1.smc.gz pop7PCAnoHVXBX01005867.1.smc.gz pop7PCAnoHVXBX01005888.1.smc.gz pop7PCAnoHVXBX01005896.1.smc.gz pop7PCAnoHVXBX01005992.1.smc.gz pop7PCAnoHVXBX01006119.1.smc.gz pop7PCAnoHVXBX01006127.1.smc.gz pop7PCAnoHVXBX01006128.1.smc.gz pop7PCAnoHVXBX01006199.1.smc.gz pop7PCAnoHVXBX01006201.1.smc.gz pop7PCAnoHVXBX01006211.1.smc.gz pop7PCAnoHVXBX01006417.1.smc.gz pop7PCAnoHVXBX01006518.1.smc.gz pop7PCAnoHVXBX01006519.1.smc.gz pop7PCAnoHVXBX01006670.1.smc.gz pop7PCAnoHVXBX01006700.1.smc.gz pop7PCAnoHVXBX01006773.1.smc.gz pop7PCAnoHVXBX01006808.1.smc.gz pop7PCAnoHVXBX01006869.1.smc.gz pop7PCAnoHVXBX01006871.1.smc.gz pop7PCAnoHVXBX01006882.1.smc.gz pop7PCAnoHVXBX01006887.1.smc.gz pop7PCAnoHVXBX01007003.1.smc.gz pop7PCAnoHVXBX01007086.1.smc.gz pop7PCAnoHVXBX01007117.1.smc.gz pop7PCAnoHVXBX01007125.1.smc.gz pop7PCAnoHVXBX01007131.1.smc.gz pop7PCAnoHVXBX01007486.1.smc.gz pop7PCAnoHVXBX01007491.1.smc.gz pop7PCAnoHVXBX01007493.1.smc.gz pop7PCAnoHVXBX01007602.1.smc.gz pop7PCAnoHVXBX01007692.1.smc.gz pop7PCAnoHVXBX01007701.1.smc.gz pop7PCAnoHVXBX01007708.1.smc.gz pop7PCAnoHVXBX01007777.1.smc.gz pop7PCAnoHVXBX01007795.1.smc.gz pop7PCAnoHVXBX01007914.1.smc.gz pop7PCAnoHVXBX01007981.1.smc.gz pop7PCAnoHVXBX01007997.1.smc.gz pop7PCAnoHVXBX01008007.1.smc.gz pop7PCAnoHVXBX01008012.1.smc.gz pop7PCAnoHVXBX01008036.1.smc.gz pop7PCAnoHVXBX01008045.1.smc.gz pop7PCAnoHVXBX01008125.1.smc.gz pop7PCAnoHVXBX01008133.1.smc.gz pop7PCAnoHVXBX01008140.1.smc.gz pop7PCAnoHVXBX01008145.1.smc.gz pop7PCAnoHVXBX01008146.1.smc.gz pop7PCAnoHVXBX01008206.1.smc.gz pop7PCAnoHVXBX01008231.1.smc.gz pop7PCAnoHVXBX01008236.1.smc.gz pop7PCAnoHVXBX01008290.1.smc.gz pop7PCAnoHVXBX01008400.1.smc.gz pop7PCAnoHVXBX01008415.1.smc.gz pop7PCAnoHVXBX01008451.1.smc.gz pop7PCAnoHVXBX01008453.1.smc.gz pop7PCAnoHVXBX01008464.1.smc.gz pop7PCAnoHVXBX01008609.1.smc.gz pop7PCAnoHVXBX01008674.1.smc.gz pop7PCAnoHVXBX01008688.1.smc.gz pop7PCAnoHVXBX01008695.1.smc.gz pop7PCAnoHVXBX01008995.1.smc.gz pop7PCAnoHVXBX01009008.1.smc.gz pop7PCAnoHVXBX01009038.1.smc.gz pop7PCAnoHVXBX01009069.1.smc.gz pop7PCAnoHVXBX01009108.1.smc.gz pop7PCAnoHVXBX01009114.1.smc.gz pop7PCAnoHVXBX01009215.1.smc.gz pop7PCAnoHVXBX01009292.1.smc.gz pop7PCAnoHVXBX01009313.1.smc.gz pop7PCAnoHVXBX01009318.1.smc.gz pop7PCAnoHVXBX01009357.1.smc.gz pop7PCAnoHVXBX01009439.1.smc.gz pop7PCAnoHVXBX01009446.1.smc.gz pop7PCAnoHVXBX01009452.1.smc.gz pop7PCAnoHVXBX01009469.1.smc.gz pop7PCAnoHVXBX01009535.1.smc.gz pop7PCAnoHVXBX01009581.1.smc.gz pop7PCAnoHVXBX01009582.1.smc.gz pop7PCAnoHVXBX01009584.1.smc.gz pop7PCAnoHVXBX01009605.1.smc.gz pop7PCAnoHVXBX01009614.1.smc.gz pop7PCAnoHVXBX01009752.1.smc.gz pop7PCAnoHVXBX01009827.1.smc.gz pop7PCAnoHVXBX01009832.1.smc.gz pop7PCAnoHVXBX01009855.1.smc.gz pop7PCAnoHVXBX01009899.1.smc.gz pop7PCAnoHVXBX01009908.1.smc.gz pop7PCAnoHVXBX01009921.1.smc.gz pop7PCAnoHVXBX01017515.1.smc.gz

# 3. joint generation of smc files from vcf 
for i in $(cat /media/labgenoma4/DATAPART6/bandriola/Scytalopus/SummaryStats/fst/1Mscaffolds.txt); do
    smc++ vcf2smc ~/Scytalopus/vcffiles/FinalVCFs/FilteredPCA_FilteredMax30missingDepthmin5_GeographicNames_allsamples.vcf.gz pop5pop67/pop5pop67$i.smc.gz $i pop5:DevonianaPR2_lin5,DevonianaPR3_lin5,DevonianaPR4_lin5,DevonianaPR5_lin5,DevonianaPR6_lin5,DevonianaPR7_lin5,DevonianaPR8_lin5,DevonianaSP1_lin5,DevonianaSP2_lin5,DevonianaSP3_lin5,DevonianaSP4_lin5,NortePR1_lin7,NortePR2_lin7,NortePR3_lin7,NortePR4_lin7,NortePR5_lin7 pop67:BoaEsperanca1_lin6,BoaEsperanca2_lin6,BoaEsperanca3_lin7
done 
for i in $(cat /media/labgenoma4/DATAPART6/bandriola/Scytalopus/SummaryStats/fst/1Mscaffolds.txt); do
    smc++ vcf2smc ~/Scytalopus/vcffiles/FinalVCFs/FilteredPCA_FilteredMax30missingDepthmin5_GeographicNames_allsamples.vcf.gz pop5pop7PCAnoH/pop5pop7PCAnoH$i.smc.gz $i pop5:DevonianaPR2_lin5,DevonianaPR3_lin5,DevonianaPR4_lin5,DevonianaPR5_lin5,DevonianaPR6_lin5,DevonianaPR7_lin5,DevonianaPR8_lin5,DevonianaSP1_lin5,DevonianaSP2_lin5,DevonianaSP3_lin5,DevonianaSP4_lin5,NortePR1_lin7,NortePR2_lin7,NortePR3_lin7,NortePR4_lin7,NortePR5_lin7 pop7PCAnoH:CentroLestePR1_lin7,CentroLesteSC1_lin7,CentroOesteSC1_lin7,CentroOesteSC2_lin7,CentroOesteSC3_lin7,CentroOesteSC4_lin7,CentroOesteSC5_lin7,ExtremoSulRS2_lin7,ExtremoSulRS3_lin7,ExtremoSulSC1_lin7
done 
for i in $(cat /media/labgenoma4/DATAPART6/bandriola/Scytalopus/SummaryStats/fst/1Mscaffolds.txt); do
    smc++ vcf2smc ~/Scytalopus/vcffiles/FinalVCFs/FilteredPCA_FilteredMax30missingDepthmin5_GeographicNames_allsamples.vcf.gz pop7PCAnoinbredpop67/pop7PCAnoinbredpop67$i.smc.gz $i pop67:BoaEsperanca1_lin6,BoaEsperanca2_lin6,BoaEsperanca3_lin7 pop7:CentroLestePR1_lin7,CentroLesteSC1_lin7,CentroOesteSC1_lin7,CentroOesteSC2_lin7,CentroOesteSC3_lin7,CentroOesteSC4_lin7,CentroOesteSC5_lin7,ExtremoSulRS2_lin7,ExtremoSulRS3_lin7,ExtremoSulSC1_lin7
done  

# 4. split
# command 1:  smc++ split -o split/ pop1/model.final.json pop2/model.final.json data/*.smc.gz
# command to plot: smc++ plot joint.pdf split/model.final.json
smc++ split -o splitpop7PCAnoHpop67/ ./pop7PCAnoH/pop7PCAnoH.final.json ./pop67/pop67.final.json ./pop7PCAnoHpop67/*.smc.gz
smc++ plot --csv -g 3.2 splitpop7pop67/splitpop7pop67.pdf splitpop7pop67/model.final.json
# the following command didnt work probabibly caused by inbred
smc++ split -o splitpop5pop7PCAnoH/ pop5/pop5.final.json pop7PCAnoH/pop7PCAnoH.final.json pop5pop7PCAnoH/*.smc.gz
smc++ plot --csv -g 3.2 splitpop5pop7PCAnoH/splitpop5pop7PCAnoH.pdf plitpop5pop7PCAnoH/model.final.json

smc++ split -o splitpop5pop67/ pop5/pop5.final.json pop67/pop67.final.json pop5pop67/*.smc.gz
smc++ plot --csv -g 3.2 splitpop5pop67/splitpop5pop67.pdf splitpop5pop67/model.final.json


